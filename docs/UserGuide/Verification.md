[Table of Contents](../README.md)

# Verifying the Generated Design
## C-RTL Cosimulation  
To verify the correctness of your circuit after generating it with Dynamatic, the easiest way is to run a simulation.  
Before doing so, you must ensure that you have done the following in your C program:  
- Included the `dynamatic/Integration.h` header
- Created a main function
- Declared and instantiated variables that will serve as inputs to your function under test
- Used the `CALL_KERNEL` macro to call the function and pass its inputs from the previous step  
> [!TIP]
> The variables declared in the `main` function must have the same names and data types as the function parameters of your function under test  

The `simulate` command runs a co-simulation of the program in C and the HDL implementation generated by Dynamatic on the same inputs.  

### Directory Structure of Cosimulation Result 
#### 1. C_SRC  
Contains a copy of the C source file under test as well as any included header files. These will be used to compile and run the C program using a regular C compiler.

#### 2. HDL_SRC  
Contains a clone of the HDL directory created by the `write-hdl` command plus the addition of a testbench file that passes the inputs from the `main` function.  

#### 3. INPUT_VECTORS  
Contains a list of `.dat` files for each input declared in the `main` function. These are passed to the C and HDL files during the co-simulation. 

#### 4. C_OUT  
Contains the results of compiling and running the C program stored as `.dat` files for every output.

#### 5. HDL_OUT  
Contains the results of running the HDL simulation of the program in Modelsim/Questa stored as `.dat` files for every output.

#### 6. HLS_VERIFY  
Contains Modelsim information and a script to compile and run the HDL simulation. It also contains testbench information and the results of the waveform transitions that occured during the simulation stored in a `vsim.wlf` file.

#### 7. report.txt  
The report file gives information on the HDL simulation in Modelsim/Questa as well as some runtime and clock cycle information. If simulation fails, this file will also contain error logs to helo the user understand the cause of failure.  

Dynamatic compares the files in `C_OUT` and `HDK_OUT` to determine whether the HDL code generated does what the C program was intended to do.