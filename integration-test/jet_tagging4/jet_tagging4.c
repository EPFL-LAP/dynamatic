#include "dynamatic/Integration.h"
#include "stdlib.h"
#include <stdio.h>
#include "nnet_utils/fc.h"

// hls-fpga-machine-learning insert layer precision
#define NB_DEFAULT 16
#define INT_DEFAULT 6
#define FRAC_DEFAULT NB_DEFAULT - INT_DEFAULT

#define NB_ACC 32
#define INT_ACC 12
#define FRAC_ACC NB_ACC - INT_ACC

typedef long dense_accum_t;
typedef int common_t;
// typedef int common_t

// Input dimensions
#define INPUT_SIZE 16

// Layer 1 dimensions
#define IN_L0 INPUT_SIZE
#define OUT_L0 64

// Layer 2 dimensions
#define IN_L1 OUT_L0
#define OUT_L1 32

// Layer 4 dimensions
#define IN_L3 OUT_L1
#define OUT_L3 5

#define UNROLL_FACTOR 8

// --------------------------------- Layer 0
const common_t w0[OUT_L0][IN_L0] = {
    -142, -259, 167,  -479, 112,  -2,   413,   -181, 262,  -38,  -2,   -107,
    200,  -89,  349,  -184, 484,  77,   0,     -2,   50,   -14,  280,  -308,
    -6,   -316, 397,  -279, 5,    322,  75,    -452, 325,  39,   419,  39,
    130,  -203, -51,  -27,  -71,  238,  147,   141,  88,   -26,  -283, 7,
    213,  222,  -481, -411, -212, -370, -148,  274,  -7,   46,   -261, 1,
    345,  -156, -116, 244,  168,  -145, 370,   45,   -109, -200, 239,  -248,
    -2,   -26,  1,    -366, -17,  0,    -724,  117,  -107, -247, -78,  9,
    -282, 1,    -82,  207,  -97,  -3,   373,   5,    -87,  -142, -569, 0,
    -2,   -3,   865,  1093, 769,  0,    -38,   -214, 143,  -182, 141,  -172,
    -403, 390,  280,  0,    -34,  35,   199,   310,  -517, 138,  -81,  154,
    269,  -79,  -3,   -31,  -1,   -8,   74,    33,   -51,  1,    14,   -9,
    343,  -354, -4,   -243, 82,   31,   286,   229,  -152, -93,  517,  -303,
    -28,  66,   -215, -451, 56,   -1,   -205,  -210, 173,  159,  210,  44,
    -208, -138, -664, -246, 233,  -101, 74,    312,  -81,  181,  167,  -182,
    0,    248,  89,   203,  6,    72,   189,   -5,   -122, 160,  0,    -466,
    -131, -158, -249, 221,  290,  -195, -233,  -349, -3,   -38,  199,  117,
    -2,   3,    -313, 161,  -104, 30,   -335,  -97,  265,  -42,  139,  181,
    209,  20,   251,  343,  177,  564,  106,   57,   326,  243,  61,   -69,
    -46,  53,   -128, 198,  -173, 8,    -995,  299,  -12,  -263, 181,  -438,
    372,  32,   0,    -48,  -200, -138, -73,   221,  0,    -207, 65,   -5,
    225,  386,  2,    -1,   -156, 66,   -3,    12,   -74,  -275, -257, -313,
    -205, -314, 737,  -359, -281, -117, -504,  -691, 170,  -264, 8,    -45,
    -124, -1,   -368, 100,  337,  2,    692,   -245, -29,  -3,   -14,  -1,
    105,  0,    0,    5,    0,    -31,  -1,    21,   0,    -1,   -83,  324,
    223,  331,  -173, -409, -364, -61,  18,    -247, 219,  471,  178,  -281,
    -346, -21,  574,  136,  306,  -108, 262,   0,    -28,  313,  299,  244,
    125,  288,  2,    -91,  35,   8,    42,    -307, 38,   29,   -56,  -328,
    402,  -87,  20,   34,   -46,  277,  5,     5,    -266, 21,   1133, -31,
    -37,  616,  0,    -4,   99,   106,  51,    -116, 1,    0,    148,  0,
    297,  0,    -3,   100,  -28,  616,  58,    -3,   187,  -138, 230,  -99,
    -4,   -160, 6,    -203, 175,  129,  -264,  1,    -92,  49,   258,  345,
    -190, 110,  222,  -12,  -17,  -107, -299,  -315, -43,  267,  349,  181,
    -380, 149,  113,  -572, 183,  -102, 245,   -204, -183, -207, 23,   -274,
    346,  -12,  -494, -258, 123,  197,  -121,  -378, 21,   0,    283,  264,
    -311, 146,  -29,  -9,   -190, -381, -882,  -105, 609,  321,  -270, -210,
    -448, 0,    57,   -173, -23,  294,  29,    298,  -61,  65,   -1,   -206,
    -50,  0,    200,  0,    -325, 104,  119,   22,   1,    -188, -43,  72,
    -178, 114,  817,  312,  -405, -150, 28,    73,   -351, 368,  270,  91,
    16,   -115, 39,   57,   -99,  -94,  -293,  -623, -150, -4,   17,   403,
    -315, 11,   150,  3,    76,   -341, 0,     -296, 10,   -235, 140,  284,
    -148, 1,    -444, -487, -97,  -84,  -216,  -180, -257, -47,  356,  123,
    -90,  6,    3,    -345, 339,  71,   -445,  -301, -386, 16,   11,   -63,
    100,  1,    251,  -108, -134, -122, 203,   -68,  31,   65,   0,    0,
    0,    -1,   110,  45,   -1,   0,    0,     -189, -43,  -115, 0,    -2,
    57,   664,  406,  -48,  -1,   75,   -130,  11,   165,  -153, 139,  -38,
    134,  -5,   -91,  -147, -92,  -15,  347,   408,  544,  -355, -366, 197,
    260,  -56,  -368, -154, 5,    79,   -689,  53,   -44,  6,    -172, -21,
    241,  132,  -31,  -174, -3,   249,  2,     -234, 0,    -5,   56,   -343,
    -377, -20,  329,  -56,  561,  -54,  34,    293,  -156, -51,  -382, -332,
    -86,  -388, -720, 322,  7,    -233, -7,    -156, -26,  -185, 36,   0,
    -274, 321,  -208, 326,  -229, -207, 59,    -291, 1,    392,  -59,  -293,
    -10,  76,   36,   202,  223,  3,    -204,  -147, 8,    -310, 491,  321,
    -4,   -234, -129, 505,  -281, 154,  -1,    158,  176,  -141, -7,   -80,
    344,  -348, -166, 274,  123,  203,  7,     -82,  576,  0,    -226, -301,
    273,  80,   18,   -102, -183, 165,  -1270, -166, -2,   -7,   169,  -2,
    364,  -81,  126,  -155, -119, 345,  -119,  375,  -72,  -131, -677, -377,
    0,    -86,  544,  157,  618,  120,  -28,   122,  -178, 35,   -234, 24,
    -290, 16,   449,  41,   78,   -19,  -635,  0,    -314, -72,  -219, -350,
    157,  -254, 204,  -161, 287,  137,  -211,  292,  231,  -364, -248, 522,
    -33,  -126, 68,   49,   23,   -228, -68,   -26,  161,  -4,   111,  158,
    122,  253,  0,    -9,   450,  -279, -29,   161,  -172, 14,   -108, -117,
    -152, 286,  1548, -163, 168,  51,   627,   390,  323,  -175, -30,  -168,
    217,  -324, -25,  -88,  0,    -283, 6,     -6,   -291, 191,  315,  -157,
    2,    -1,   8,    97,   -104, 101,  -208,  -128, -303, 2,    -902, -7,
    -118, -212, 369,  41,   84,   335,  29,    0,    51,   -359, 52,   315,
    -337, -246, -644, -51,  216,  169,  -10,   77,   238,  -1,   5,    -246,
    27,   -63,  -73,  155,  87,   -1,   1014,  -18,  44,   -1,   -686, -612,
    -196, -48,  -143, 168,  -166, 258,  -12,   -41,  -190, -20,  406,  457,
    101,  15,   -183, -37,  -82,  63,   -20,   248,  -19,  -1,   279,  -531,
    -213, -325, 276,  295,  -388, -242, 19,    275,  14,   46,   -5,   -160,
    186,  318,  2,    -40,  317,  -152, -821,  368,  -298, -120, -446, -597,
    -474, 0,    -11,  -193, 306,  -333, -244,  -96,  50,   -11,  -154, -120,
    11,   2,    -126, 3,    3,    16,   0,     184,  153,  0,    138,  6,
    392,  12,   -96,  -15,  -238, 168,  -2,    -138, -319, -34,  -149, -3,
    355,  -138, 107,  62,   348,  182,  560,   296,  211,  512,  -91,  -468,
    42,   -92,  -3,   -9,   -76,  443,  -56,   -186, 93,   -166, 394,  15,
    -173, -160, 551,  632,  454,  0,    270,   -12,  -211, 81,   141,  -103,
    -350, 47,   663,  -165, 183,  318,  422,   200,  252,  -286, -8,   -205,
    267,  -300, 534,  23,   25,   -298, -331,  -247, 346,  237,  323,  48,
    406,  -375, -270, 72,   41,   -183, -195,  -178, 303,  174,  -822, 208,
    -111, -19,  -147, 103,  -13,  -465, 273,   -337, 221,  85,   -62,  4,
    -230, 107,  703,  21,   -195, 66,   -41,   466,  262,  -30,  170,  -237,
    -90,  62,   0,    -36,  -1,   -122, 987,   -58,  -273, 101,  408,  -1,
    -31,  -319, -34,  -367, 0,    92,   -177,  202,  -397, 185,  581,  -319,
    -115, -12,  253,  -2,   80,   0,    -190,  270,  146,  255,  -5,   60,
    -4,   193,  3,    -547};
const common_t b0[OUT_L0] = {
    177, 247,  293, 92,  202, 227, -37, -457, 269, 241, -86, 250, 1,
    100, 268,  -39, 270, -77, 216, 90,  195,  112, 103, -86, 343, 217,
    -17, -114, -72, -91, 42,  196, -98, 87,   121, -7,  77,  209, -232,
    -1,  463,  28,  205, -46, -38, 71,  101,  333, 169, 164, 47,  61,
    218, 153,  -83, 148, 293, -96, 268, 280,  -18, -28, 72,  358};

const common_t w1[OUT_L1][IN_L1] = {
    87,   204,  40,   -108, 3,    -77,  -359, 0,    186,  0,    0,     25,
    -187, 0,    288,  -43,  328,  1,    145,  64,   -3,   97,   63,    -52,
    306,  0,    -61,  -173, 0,    -118, 108,  185,  -97,  1,    1,     -2,
    1,    228,  -118, 1,    0,    18,   -188, -158, -22,  -4,   0,     0,
    16,   -2,   -29,  -2,   -84,  9,    38,   -32,  79,   -6,   25,    16,
    1,    -31,  2,    33,   -3,   -35,  50,   135,  85,   9,    -2,    0,
    -10,  93,   -6,   126,  2,    3,    0,    56,   -4,   3,    75,    56,
    74,   221,  118,  248,  76,   47,   38,   -57,  -435, 119,  -126,  107,
    10,   61,   -28,  0,    91,   -101, 1,    105,  -96,  -134, -3,    -1,
    68,   -120, -17,  -75,  58,   -140, 331,  274,  35,   -119, 161,   237,
    244,  62,   -1,   1,    -118, -89,  -100, -125, -42,  1,    2,     33,
    -44,  70,   0,    0,    -50,  -25,  2,    107,  127,  -60,  48,    16,
    -217, 57,   1,    -44,  -89,  209,  5,    106,  -77,  -97,  164,   2,
    0,    151,  -141, -36,  1,    168,  0,    -1,   187,  9,    93,    274,
    -226, -84,  -6,   308,  44,   224,  140,  -112, 8,    2,    352,   91,
    195,  10,   -25,  186,  -2,   167,  -15,  -211, -58,  19,   -3,    -4,
    1,    166,  69,   4,    0,    -36,  234,  0,    3,    -189, -4,    -61,
    0,    4,    5,    63,   49,   0,    0,    247,  -6,   2,    4,     -23,
    -1,   -140, 204,  0,    -196, 136,  121,  -47,  -15,  207,  107,   -18,
    66,   -1,   0,    48,   0,    67,   -53,  35,   141,  -153, 136,   -103,
    1,    64,   -19,  0,    -17,  32,   7,    2,    20,   -1,   282,   110,
    1,    111,  -1,   25,   114,  90,   17,   -2,   -69,  3,    -22,   -2,
    0,    -26,  -126, -17,  0,    150,  53,   76,   -90,  0,    -1,    43,
    0,    215,  209,  -41,  1,    -10,  71,   -191, 0,    -4,   6,     -1,
    -1,   123,  4,    0,    77,   -2,   -1,   -3,   2,    6,    -1,    -2,
    -5,   -55,  71,   -41,  -3,   0,    -2,   -3,   178,  -260, 74,    72,
    119,  -11,  243,  2,    0,    -163, -7,   123,  0,    58,   38,    -221,
    7,    145,  -53,  -216, 49,   178,  142,  40,   -221, -5,   313,   -89,
    -68,  -114, -53,  189,  95,   -1,   0,    -7,   0,    0,    131,   0,
    303,  -55,  -95,  2,    -41,  0,    203,  -2,   162,  5,    0,     -298,
    83,   25,   1,    2,    -39,  8,    115,  140,  112,  -28,  -134,  -144,
    -410, 73,   0,    -11,  -237, 191,  18,   -23,  52,   -105, 106,   116,
    -1,   167,  1,    72,   0,    12,   4,    0,    -120, 145,  7,     -38,
    -34,  10,   0,    -99,  -167, 2,    -3,   174,  -119, 38,   0,     0,
    -4,   216,  223,  1,    -173, -5,   65,   -8,   -1,   226,  -164,  0,
    -57,  80,   1,    98,   6,    1,    -10,  13,   1,    0,    -1,    59,
    79,   -7,   1,    -2,   6,    0,    150,  2,    -1,   5,    -4,    123,
    -73,  5,    -56,  3,    18,   -301, 0,    176,  -21,  2,    -24,   -103,
    -1,   65,   5,    14,   50,   -95,  105,  1,    130,  -2,   44,    2,
    131,  99,   -2,   39,   79,   -88,  114,  150,  1,    -45,  127,   81,
    5,    -5,   0,    1,    198,  -36,  129,  0,    -87,  -10,  43,    196,
    -258, 91,   -114, 299,  58,   0,    75,   -1,   4,    199,  -15,   266,
    -50,  131,  -255, -288, -3,   0,    110,  0,    23,   23,   0,     48,
    0,    138,  -3,   0,    -40,  -1,   -1,   144,  0,    34,   37,    -39,
    -2,   -1,   127,  94,   -155, 177,  -1,   -7,   -1,   209,  112,   -8,
    77,   -36,  98,   181,  0,    -2,   0,    3,    16,   0,    -2,    -1,
    246,  -1,   -62,  60,   -1,   -503, -172, -3,   1,    -303, 207,   -2,
    -1,   -1,   -72,  108,  -1,   0,    -187, 0,    -3,   -10,  -6,    0,
    -13,  34,   8,    -1,   -42,  0,    253,  0,    128,  -286, 3,     165,
    2,    0,    1,    0,    94,   0,    43,   -1,   38,   2,    0,     123,
    -178, -236, 0,    1,    -2,   70,   -63,  0,    0,    1,    0,     0,
    2,    51,   -2,   -1,   -393, 0,    4,    -4,   -2,   374,  0,     -2,
    -57,  163,  0,    -2,   2,    -2,   -8,   2,    155,  259,  0,     -280,
    56,   1,    189,  0,    6,    15,   1,    -537, 45,   -142, -303,  1,
    50,   1,    -113, 2,    -8,   3,    130,  13,   0,    -24,  -30,   4,
    0,    1,    7,    -201, 232,  2,    -178, -73,  2,    1,    -45,   30,
    2,    -1,   188,  0,    137,  5,    -50,  -48,  214,  1,    41,    -433,
    2,    -107, 19,   149,  26,   -73,  -261, 3,    267,  -7,   2,     -14,
    -2,   0,    72,   145,  -55,  -228, 4,    134,  82,   -18,  -3,    146,
    -239, -150, 479,  0,    153,  -313, -4,   -35,  -107, -125, 2,     233,
    113,  -1,   49,   -59,  330,  1,    4,    84,   -62,  -346, 1,     -6,
    1,    -3,   1,    -93,  0,    1,    -29,  1,    -140, 52,   14,    -6,
    -661, -126, 107,  1,    108,  423,  228,  -220, -254, 62,   138,   0,
    -15,  -202, 4,    2,    115,  140,  31,   -274, 364,  222,  281,   -72,
    182,  43,   157,  -12,  18,   -178, 11,   0,    267,  3,    2,     -18,
    -47,  2,    56,   26,   3,    -26,  2,    -55,  3,    3,    43,    -287,
    63,   0,    -96,  -246, -206, 1,    212,  54,   1,    6,    2,     0,
    162,  -90,  1,    -2,   23,   1,    -62,  0,    0,    1,    233,   150,
    2,    3,    0,    2,    57,   36,   25,   -40,  5,    -318, 305,   487,
    1,    0,    119,  14,   6,    -35,  3,    -219, 148,  -5,   215,   -487,
    238,  0,    154,  80,   119,  -118, 64,   26,   9,    -1,   -57,   0,
    107,  0,    -1,   -20,  1,    -3,   -4,   0,    -1,   -139, 1,     0,
    100,  71,   1,    171,  9,    11,   -1,   -23,  -132, -3,   255,   2,
    -181, 104,  108,  60,   26,   0,    4,    -33,  0,    -67,  -160,  -86,
    -152, 141,  16,   0,    -13,  -138, 4,    8,    120,  208,  -87,   -229,
    2,    178,  -872, 0,    285,  313,  -79,  264,  -112, 2,    40,    61,
    111,  49,   -1,   129,  140,  0,    73,   -315, 324,  78,   -1,    -503,
    1,    1,    112,  86,   0,    27,   17,   23,   19,   127,  -7,    -18,
    130,  0,    -66,  -84,  -6,   1,    20,   75,   3,    118,  -94,   0,
    143,  0,    14,   96,   28,   -493, 57,   33,   -86,  -5,   87,    302,
    144,  70,   -2,   -477, -7,   -263, -193, -249, 420,  -92,  0,     55,
    -2,   -280, 266,  264,  167,  0,    114,  7,    211,  138,  0,     -77,
    161,  -341, -7,   -141, -4,   -4,   46,   19,   0,    8,    -25,   136,
    -193, -1,   3,    -155, -448, -30,  234,  8,    -4,   6,    -46,   -33,
    -3,   75,   -217, 2,    -98,  -113, 1,    118,  43,   -42,  81,    -186,
    47,   90,   83,   158,  -23,  17,   129,  -38,  15,   220,  207,   -55,
    -16,  -102, -17,  -204, -92,  385,  106,  65,   -536, 0,    -457,  0,
    -116, 43,   59,   0,    4,    -48,  1,    -261, 97,   94,   -226,  -30,
    -1,   0,    563,  0,    206,  -141, -369, -2,   390,  108,  256,   29,
    -50,  -356, 82,   230,  210,  0,    -515, -98,  260,  -117, -39,   -172,
    -161, -23,  316,  206,  -89,  -16,  120,  -4,   -200, 87,   151,   -51,
    179,  35,   83,   -57,  1,    103,  -48,  -9,   -109, 306,  3,     -135,
    -447, 31,   -400, 66,   34,   47,   299,  -29,  -3,   50,   -13,   -31,
    -1,   -132, -143, -160, -2,   171,  167,  0,    64,   1,    -3,    40,
    409,  229,  14,   -100, 3,    -207, 223,  148,  330,  53,   -288,  -88,
    116,  -53,  9,    -145, -254, -6,   342,  394,  -164, -29,  112,   0,
    0,    -81,  1,    0,    -1,   0,    40,   0,    2,    0,    91,    -73,
    2,    2,    -78,  -3,   -1,   2,    0,    3,    45,   -62,  0,     178,
    0,    1,    0,    3,    2,    0,    0,    0,    0,    2,    1,     0,
    0,    0,    145,  3,    0,    0,    59,   0,    2,    117,  0,     3,
    0,    1,    0,    0,    1,    0,    3,    -6,   -1,   198,  0,     0,
    24,   22,   -42,  3,    -32,  -86,  -47,  -1,   -2,   -2,   -60,   -358,
    1,    -2,   112,  -180, 2,    -105, -1,   -8,   0,    17,   0,     15,
    105,  2,    -168, 168,  0,    -3,   -2,   -30,  0,    -131, -1,    -2,
    0,    -14,  -39,  232,  -179, 0,    4,    -331, -3,   0,    52,    -1,
    -554, 296,  -44,  335,  197,  197,  4,    -11,  -188, -5,   -210,  -46,
    -143, 49,   -86,  -10,  -3,   1,    110,  202,  -44,  0,    120,   0,
    8,    -135, -30,  -549, 167,  0,    2,    283,  0,    -62,  57,    112,
    45,   -65,  135,  -8,   73,   49,   -2,   118,  98,   2,    -66,   16,
    85,   -20,  -289, -116, 1,    -1,   26,   27,   143,  6,    -78,   -73,
    1,    -1,   260,  -77,  -340, 341,  24,   277,  246,  80,   -66,   -1,
    -27,  33,   -113, 142,  0,    32,   -40,  3,    -88,  -1,   269,   143,
    20,   3,    -46,  118,  -2,   -222, -62,  0,    0,    -3,   2,     190,
    2,    -44,  -7,   121,  104,  -51,  306,  11,   -3,   137,  14,    -62,
    -84,  3,    200,  -34,  -108, -63,  43,   48,   3,    66,   -26,   3,
    -205, -1,   3,    0,    -245, -75,  -6,   -2,   12,   -3,   -16,   -40,
    -57,  -63,  100,  1,    -103, 56,   -14,  97,   166,  -10,  0,     2,
    -114, -33,  -7,   4,    -76,  3,    10,   -151, 76,   -40,  148,   -2,
    59,   199,  -157, -51,  -9,   317,  63,   55,   -315, 0,    -303,  65,
    -67,  52,   -5,   3,    322,  164,  -218, -162, 213,  115,  118,   -313,
    -1,   -71,  289,  1,    40,   -171, -341, 78,   211,  33,   -112,  -307,
    -4,   -105, 305,  123,  -3,   11,   -438, -34,  266,  -15,  143,   -32,
    -286, -3,   273,  310,  -160, -140, -40,  41,   322,  -1,   -19,   53,
    -129, 45,   -46,  79,   -4,   -2,   -14,  124,  115,  -4,   -2,    -10,
    459,  3,    335,  0,    94,   65,   -29,  -164, -3,   -77,  1,     50,
    0,    99,   136,  194,  2,    -33,  -81,  -85,  -269, 71,   0,     1,
    -291, -300, 0,    16,   32,   239,  -5,   -90,  -247, -75,  224,   117,
    -158, 36,   -1,   134,  198,  -56,  -269, -378, -4,   146,  -4,    -26,
    3,    74,   1,    -12,  -309, -153, 93,   0,    179,  -333, -3,    20,
    -2,   1,    11,   183,  355,  -19,  267,  45,   90,   0,    29,    46,
    -138, -333, -38,  -38,  0,    -87,  -85,  -4,   111,  6,    -114,  2,
    20,   4,    0,    -34,  -700, -32,  151,  -12,  -2,   430,  27,    -236,
    -52,  296,  56,   139,  -18,  -165, -33,  -5,   246,  255,  -1,    -340,
    248,  2,    229,  -94,  15,   1,    -20,  0,    94,   -24,  -1,    0,
    2,    153,  0,    88,   86,   69,   24,   -19,  14,   -72,  200,   145,
    -563, -27,  157,  1,    181,  246,  42,   0,    -75,  1,    206,   225,
    1,    18,   3,    2,    -81,  22,   57,   1,    168,  0,    -418,  0,
    51,   -402, -86,  89,   89,   -587, -2,   104,  6,    1,    -4,    29,
    21,   -1,   4,    212,  -191, -678, -281, 34,   166,  22,   -212,  80,
    -217, -33,  -153, 200,  121,  38,   -77,  -6,   80,   -370, 0,     51,
    568,  0,    1,    56,   209,  0,    -79,  0,    11,   -88,  -86,   23,
    22,   221,  306,  195,  0,    -105, -351, -44,  -230, 248,  127,   54,
    -109, -61,  -65,  2,    0,    57,   15,   -71,  -106, 242,  82,    0,
    4,    159,  63,   261,  248,  2,    -52,  -301, 77,   89,   -1,    -2,
    33,   19,   -151, -184, -21,  -240, 134,  1,    61,   -33,  0,     -98,
    42,   -28,  -1,   231,  223,  -2,   47,   9,    242,  32,   4,     0,
    -115, -349, 1,    -3,   -40,  112,  -50,  0,    -35,  -119, -338,  39,
    -238, 109,  50,   18,   -555, -43,  5,    0,    9,    400,  -114,  -136,
    -277, 49,   13,   136,  16,   -74,  5,    16,   143,  291,  98,    -288,
    244,  316,  213,  0,    -153, -206, 1,    15,   -1,   16,   -47,   0,
    -246, 0,    -5,   51,   5,    2,    -21,  201,  -1,   0,    2,     -18,
    -115, -5,   1,    35,   107,  117,  76,   136,  0,    33,   4,     0,
    5,    0,    84,   3,    242,  -102, 156,  -2,   5,    0,    -46,   0,
    -2,   4,    54,   18,   0,    2,    214,  58,   157,  15,   8,     2,
    2,    -76,  -94,  0,    -154, 2,    0,    -64,  -19,  80,   194,   34,
    -1,   -185, 21,   0,    1,    -130, -174, 33,   2,    103,  0,     309,
    -389, 2,    52,   -1,   -111, 9,    99,   2,    142,  42,   2,     4,
    -105, 16,   0,    63,   24,   262,  168,  0,    -28,  -3,   -88,   -1,
    118,  -109, 3,    -17,  85,   -23,  135,  -5,   -8,   81,   -269,  13,
    -43,  -220, 3,    92,   277,  -4,   456,  311,  0,    0,    88,    3,
    -1,   308,  0,    120,  -4,   -101, 7,    0,    0,    -1,   1,     0,
    -4,   4,    0,    33,   1,    2,    50,   110,  -531, 283,  150,   1,
    73,   59,   61,   0,    -60,  -29,  113,  0,    0,    188,  -20,   4,
    -5,   3,    0,    -3,   15,   13,   -75,  -213, 76,   -582, 4,     0,
    3,    -397, -182, -4,   -328, -145, 3,    13,   218,  0,    202,   68,
    -202, -196, -1,   4,    0,    130,  10,   -24,  93,   2,    -1096, 0,
    143,  84,   1,    -37,  -77,  -1,   -44,  0,    0,    1,    -3,    210,
    4,    58,   203,  2,    -2,   223,  225,  0,    0,    -38,  248,   26,
    -4,   10,   -70,  -1,   -116, 40,   16,   0,    105,  0,    -277,  83,
    2,    24,   -1,   0,    120,  2,    -89,  0,    -248, 159,  -60,   99,
    231,  -382, 0,    26,   5,    12,   -71,  0};
const common_t b1[OUT_L1] = {320, -25, -98,  145, 122, 85,  -86, 11,
                              38,  -35, 331,  79,  454, 139, 358, 287,
                              3,   109, -291, -77, 122, -80, 145, 111,
                              -64, -52, 135,  -93, -86, 131, -21, 94};

const common_t w3[OUT_L3][IN_L3] = {
    -396, 42,   -266, -16,  -163, 9,    571,  255,   -242, 81,   127,  62,
    39,   441,  -53,  -454, 401,  -423, -125, 61,    253,  342,  617,  1029,
    0,    -646, 82,   -12,  271,  385,  -265, -410,  -314, 71,   -380, 246,
    -40,  60,   270,  -18,  253,  -246, 476,  327,   250,  4,    -349, -246,
    284,  257,  115,  199,  -500, -141, 422,  -322,  -136, 138,  192,  0,
    -331, -326, 12,   -42,  -405, -430, 232,  556,   -170, 538,  -204, -364,
    308,  175,  -17,  -263, -224, -93,  162,  314,   -26,  -356, 265,  -411,
    -253, 291,  -631, 323,  -17,  425,  -72,  101,   55,   46,   -244, -269,
    41,   -410, 603,  688,  -35,  53,   -373, 190,   -937, 149,  -503, -463,
    155,  -666, 214,  132,  523,  522,  -513, -30,   398,  -74,  0,    -1560,
    0,    202,  -268, -201, -448, 152,  461,  231,   545,  -311, -286, -844,
    337,  -712, -312, -57,  180,  -694, 139,  60,    77,   -555, 387,  444,
    -840, -417, 47,   59,   129,  -2,   0,    -1235, -14,  -175, 438,  186,
    -64,  -747, -430, 326};
const common_t b3[OUT_L3] = {-130, 74, -95, -88, 159};

void jet_tagging4(
    // clang-format off
    common_t input_0,
    common_t input_1,
    common_t input_2,
    common_t input_3,
    common_t input_4,
    common_t input_5,
    common_t input_6,
    common_t input_7,
    common_t input_8,
    common_t input_9,
    common_t input_10,
    common_t input_11,
    common_t input_12,
    common_t input_13,
    common_t input_14,
    common_t input_15,

    common_t out3_0[1],
    common_t out3_1[1],
    common_t out3_2[1],
    common_t out3_3[1],
    common_t out3_4[1]
    // clang-format on
) {

  common_t out0[OUT_L0];
  common_t out1[OUT_L1];
  common_t out3[OUT_L3];
  common_t tmp_input[IN_L0];

  tmp_input[0] = input_0;
  tmp_input[1] = input_1;
  tmp_input[2] = input_2;
  tmp_input[3] = input_3;
  tmp_input[4] = input_4;
  tmp_input[5] = input_5;
  tmp_input[6] = input_6;
  tmp_input[7] = input_7;
  tmp_input[8] = input_8;
  tmp_input[9] = input_9;
  tmp_input[10] = input_10;
  tmp_input[11] = input_11;
  tmp_input[12] = input_12;
  tmp_input[13] = input_13;
  tmp_input[14] = input_14;
  tmp_input[15] = input_15;

//   if (tmp_input[15] == 996) {
//     out1[0] = 1024;
//     out1[1] = 1024;
//     out1[2] = 1024;
//     out1[3] = 1024;
//     out1[4] = 1024;
//     out1[5] = 1024;
//     out1[6] = 1024;
//     out1[7] = 1024;
//     out1[8] = 1024;
//     out1[9] = 1024;
//     out1[10] = 1024;
//     out1[11] = 1024;
//     out1[12] = 1024;
//     out1[13] = 1024;
//     out1[14] = 1024;
//     out1[15] = 1024;
//     out1[16] = 1024;
//     out1[17] = 1024;
//     out1[18] = 1024;
//     out1[19] = 1024;
//     out1[20] = 1024;
//     out1[21] = 1024;
//     out1[22] = 1024;
//     out1[23] = 1024;
//     out1[24] = 1024;
//     out1[25] = 1024;
//     out1[26] = 1024;
//     out1[27] = 1024;
//     out1[28] = 1024;
//     out1[29] = 1024;
//     out1[30] = 1024;
//     out1[31] = 1024;
//   } else {  
      /* ----------- Layer 0 ------------ */
      dense_accum_t acc0;
      common_t tmp_relu0;
      DENSE_RELU_LAYER(tmp_input, out0, IN_L0, OUT_L0, w0, b0, acc0, tmp_relu0);
    
      /* ----------- Layer 1 ------------ */
      dense_accum_t acc1;
      common_t tmp_relu1 = 0;
      DENSE_RELU_LAYER(out0, out1, IN_L1, OUT_L1, w1, b1, acc1, tmp_relu1);
    
    // }
    /* ----------- Layer 3 ------------ */
    dense_accum_t acc3;
    common_t tmp_relu3 = 0;
    DENSE_RELU_LAYER(out1, out3, IN_L3, OUT_L3, w3, b3, acc3, tmp_relu3);
  
    out3_0[0] = out3[0];
    out3_1[0] = out3[1];
    out3_2[0] = out3[2];
    out3_3[0] = out3[3];
    out3_4[0] = out3[4];

}

int main(void) {

  // clang-format off
  srand(13);
  common_t input_0  = -1090;
  common_t input_1  = 698;
  common_t input_2  = 2226;
  common_t input_3  = 2287;
  common_t input_4  = 2099;
  common_t input_5  = 2408;
  common_t input_6  = -136;
  common_t input_7  = 233;
  common_t input_8  = -136;
  common_t input_9  = 928;
  common_t input_10 = 1137;
  common_t input_11 = 1651;
  common_t input_12 = 933;
  common_t input_13 = 1429;
  common_t input_14 = 1856;
  common_t input_15 = 996;

  common_t out3_0[1]; // EXPECTED: 0
  common_t out3_1[1]; // EXPECTED: 0
  common_t out3_2[1]; // EXPECTED: 1
  common_t out3_3[1]; // EXPECTED: 0
  common_t out3_4[1]; // EXPECTED: 0
  // clang-format on

  // CALL_KERNEL(jet_tagging2, input, out0, out1, out2, out3);
  //
  CALL_KERNEL(
      // clang-format off
      jet_tagging4,
      input_0,
      input_1,
      input_2,
      input_3,
      input_4,
      input_5,
      input_6,
      input_7,
      input_8,
      input_9,
      input_10,
      input_11,
      input_12,
      input_13,
      input_14,
      input_15,
      out3_0,
      out3_1,
      out3_2,
      out3_3,
      out3_4
      // clang-format on
  );


  return 0;
}