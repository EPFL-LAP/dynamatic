MODULE tfifo_NUM_SLOTS (ins, ins_valid, outs_ready)
VAR inner_elastic_fifo : elastic_fifo_inner(ins, fifo_valid, fifo_ready, NUM_SLOTS);
DEFINE fifo_valid := ins_valid & (!outs_ready | inner_elastic_fifo.outs_valid);
DEFINE fifo_ready := outs_ready;
DEFINE outs_valid := ins_valid | inner_elastic_fifo.outs_valid;
DEFINE ins_ready := inner_tehb.ins_ready | outs_ready;
DEFINE outs := case
                inner_elastic_fifo.outs_valid : elastic_fifo_inner.outs;
                TRUE : ins;
              esac;